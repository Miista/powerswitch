<style>
body {
  min-width:357px;
  overflow-x:hidden;
}

img {
  margin:5px;
  border:2px solid black;
  vertical-align:middle;
  width:75px;
  height:75px;
}
</style>

<body>
  <input id="input"/>
  <div id="tabs_list">

  </div>
</body>

<script>
  var background = chrome.extension.getBackgroundPage();

  var displayMatchingTabs = function() {
    var input = document.getElementById("input");
    var tabs_list_div = document.getElementById('tabs_list');

    tabs_list_div.innerHTML = "";
    var filter_text = input.value.toLowerCase();
    background.ordered_tabs.forEach(function(tab) {
      if (tab.title.toLowerCase().indexOf(filter_text) === -1) {
        return;
      }

      var p = document.createElement('p');
      p.innerText = tab.title;

      tabs_list_div.appendChild(p);
      p.onclick = function(event) {
        chrome.windows.getCurrent(function(window) {
          chrome.tabs.update(tab.id, {selected: true});
          chrome.windows.remove(window.id);
        });
      };
    });
  };

  setTimeout(function() {
    displayMatchingTabs();
    var input = document.getElementById("input");
    input.focus();
    input.addEventListener("input", function(event) {
      displayMatchingTabs();
    }, /*useCapture=*/ false);
  }, 1);

</script>
